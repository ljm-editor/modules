var _=Object.defineProperty;var g=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var h=(t,e,o)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,f=(t,e)=>{for(var o in e||(e={}))$.call(e,o)&&h(t,o,e[o]);if(g)for(var o of g(e))j.call(e,o)&&h(t,o,e[o]);return t};import{e as c,d as y,g as d,a as v,h as b}from"./main.a67208f8.js";import{c as M,m as S,r as p,W as B,a as E,g as T}from"./index.04e0b753.js";import{c as k}from"./cloneDeep.c9a8d33d.js";import"./vue-libs.882c34e2.js";const x=[{key:"ax21sa",topic:{},topicName:"\u5065\u5EB7\u4F53\u68C0",tagName:"\u9650\u65F6",tagColor:"#ffffff",tagBgColor:"#FF553B",bgColor:"#ffffff",bgImg:{},products:[{id:1,name:"\u631A\u7231\u7EA2\u989C\u4F53\u68C0\u5957\u9910",_coverImg:"https://img.mytijian.com/common/img/2022-04/1649903329-NiElcr.png",_price:139.9,_linePrice:1400},{id:2,name:"\u5E94\u916C\u65CF\u4F53\u68C0\u5957\u9910",_coverImg:"https://img.mytijian.com/common/img/2022-04/1649903330-VTROoS.png",_price:2831,_linePrice:2900},{id:3,name:"\u5915\u9633\u7EA2\u5347\u7EA7\u4F53\u68C0\u5957\u9910\uFF0C\u5173\u7231\u8001\u5E74\u5065\u5EB7\u751F\u6D3B",_coverImg:"https://img.mytijian.com/common/img/2022-04/1649903330-8tlqjz.png",_price:1676,_linePrice:2e3}]}],[z,a]=M({name:"goods-topic",desc:"\u5546\u54C1\u8D27\u67B6",group:"\u4E1A\u52A1\u6A21\u5757",tags:["\u8D27\u67B6","\u4E13\u9898"],order:5});var D={name:"ljm-goods-topic-products",mixins:[S],props:{column:Number,list:{type:Array,default:()=>[]}},methods:{getProductStyle(t,e){const{column:o,addUnit:i}=this,s={marginRight:0};return(e+1)%(o===1?3:2)!==0&&(s.marginRight=i(10)),s},onClick(t){return()=>this.$emit("click",t)}},render(){const t=arguments[0];return t("div",{class:a("body")},[this.list.map((e,o)=>t("div",{class:a("product"),style:this.getProductStyle(e,o),on:{click:this.onClick(e)}},[t("div",{class:a("product-img"),style:{backgroundImage:`url(${e._coverImg})`}}),t("div",{class:a("product-info")},[t("div",{class:a("product-name")},[e.name]),t("div",{class:a("product-price")},[t("div",{class:a("product-price-unit")},["\uFFE5"]),t("div",{class:a("product-price-number")},[e._price])])])]))])}};const R={props:{column:{type:Number,default:1,editor:{type:"ext-props-input",span:12,formItemProps:{label:"\u5217\u6570",labelCol:{span:6},wrapperCol:{span:8}},props:{icon:"icon-3column",min:1,max:2}}},radius:{type:Number,default:8,editor:{type:"ext-props-input",formItemProps:{label:"\u5706\u89D2",labelCol:{span:6},wrapperCol:{span:18}},span:12,props:{min:0,unit:"\u02DA",icon:"icon-yuanjiao2"}}},gap:{type:Number,default:10,visible:!1,editor:{type:"ext-props-input",props:{min:0},span:12,formItemProps:{label:"\u95F4\u9694",labelCol:{span:6},wrapperCol:{span:18}},props:{icon:"icon-resize-h"}}},list:{type:Array,default:()=>[],editor:{type:"custom"}}},triggers:{onClickMore:"click:more",onClickItem:"click:item"},computed:{showList(){if(this.isProduction)return this.list;const t=k(this.list);let e=0;for(t.length<this.column&&(e=this.column-t.length);e--;){const o=k(x[0]);o.key=p(),t.push(o)}return t}},methods:{onClickMore(t){return()=>{const{eventNamespace:e,$options:o}=this,{triggers:i}=o,s=`${e}:${i.onClickMore}`;c.emit(s,{data:t})}},onClickItem(t){return()=>{const{eventNamespace:e,$options:o}=this,{triggers:i}=o,s=`${e}:${i.onClickItem}`;c.emit(s,{data:t})}},getTagStyle(t){return{backgroundColor:t.tagBgColor}},getCardStyle(t,e){const{gap:o,column:i,list:s,radius:r}=this,l=s.length;let n={backgroundColor:t.bgColor,borderRadius:this.addUnit(r)};t.bgImg&&t.bgImg.url&&(n.backgroundImage=`url(${t.bgImg.url})`),i!==1&&(e+1)%i!==0&&(n.marginRight=this.addUnit(o));const u=Math.ceil(l/i);u>1&&(n.marginBottom=Math.ceil((e+1)/i)===u?0:this.addUnit(o));const[,N,,w]=this.wrapPadding;return n.width=i===1?"100%":this.addUnit((375-N-w-.5-(i-1)*o)/i),n}},render(){const t=arguments[0],{column:e,gap:o,showList:i}=this;return t(B,{attrs:{wrapStyle:this.wrapStyle,innerStyle:this.wrapInnerStyle}},[t("div",{class:a()},[i.map((s,r)=>t("div",{class:a("item",[`col${e}`]),key:s.key,style:this.getCardStyle(s,r)},[t("div",{class:a("head"),on:{click:this.onClickMore(s)}},[t("div",{class:a("head-title")},[t("div",{class:a("head-title-txt")},[s.topicName]),s.tagName!==""&&t("div",{class:a("head-title-tag"),style:this.getTagStyle(s)},[s.tagName])]),t("div",{class:a("head-more")},[t("div",{class:a("head-more-icon")})])]),t(D,{attrs:{list:s.products,column:e},on:{click:this.onClickItem}})]))])])}};var F=z(R);const P=F;const I="ljm-goods-topic-editor",m=E(I);var A={name:I,props:{moduleProps:{type:Object,default:()=>({list:[]})}},components:{draggable:y},data(){return{activedTopic:null,activedIndex:null}},methods:{onClickItem(t){return()=>{this.activedIndex=t,this.activedTopic=this.moduleProps.list[t]}},onDelete(t){return e=>{e.stopPropagation(),this.moduleProps.list.splice(t,1)}},onEdit(t){return e=>{this.activedIndex=t,this.activedTopic=this.moduleProps.list[t],c.emit(d,{data:this.moduleProps.list[t],success:({data:o})=>{const i=this.moduleProps.list.slice();i[t]=o,this.moduleProps.list=i}})}},onAdd(){c.emit(d,{success:({data:t})=>{t.key=p(),t.topicName=t.topicName||t.topic.name,t.bgColor=t.bgColor||"#ffffff",t.tagName=t.tagName||"",t.tagColor=t.tagColor||"#ffffff",t.tagBgColor=t.tagBgColor||"#FF553B",this.moduleProps.list.push(t)}})}},render(){const t=arguments[0],{activedTopic:e,activedIndex:o,moduleProps:i}=this,{list:s}=i;return t("div",[t("div",{class:m("add")},[t("a-button",{attrs:{icon:"plus",size:"small"},on:{click:this.onAdd}},["\u6DFB\u52A0\u5546\u54C1\u8D27\u67B6"])]),t(y,{attrs:{handle:".ljm-goods-topic-editor-handle"},model:{value:this.moduleProps.list,callback:r=>{this.$set(this.moduleProps,"list",r)}}},[t("transition-group",[s.map((r,l)=>t("div",{class:m("topic-item",[l===o&&"actived"]),key:r.key,on:{click:this.onClickItem(l)}},[t("div",{class:m("topic-item-name")},[r.topicName]),t("div",{class:m("topic-item-actions")},[l!==0&&t("a-button",{attrs:{type:"link",size:"small",icon:"delete"},style:"color: red;",on:{click:this.onDelete(l)}}),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{class:"ljm-goods-topic-editor-handle",attrs:{type:"link",size:"small",icon:"drag"}}),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{attrs:{type:"link",size:"small",icon:"edit"},on:{click:this.onEdit(l)}})])]))])]),!!e&&t("div",{class:m("topic-edit")},[t("a-form",{attrs:{labelCol:{span:4},wrapperCol:{span:20}}},[t("a-form-item",{attrs:{label:"\u8D27\u67B6\u540D:"}},[t("a-input",{attrs:{size:"small"},style:"width: 186px",model:{value:e.topicName,callback:r=>{this.$set(e,"topicName",r)}}})]),t("a-form-item",{attrs:{label:"\u80CC\u666F\u56FE"}},[t("ext-img-select",{model:{value:e.bgImg,callback:r=>{this.$set(e,"bgImg",r)}}})]),t("a-form-item",{attrs:{label:"\u80CC\u666F\u8272"}},[t("ext-color-picker",{model:{value:e.bgColor,callback:r=>{this.$set(e,"bgColor",r)}}})]),t("a-form-item",{attrs:{label:"\u6807\u7B7E\u540D"}},[t("a-input",{attrs:{size:"small"},style:"width: 186px",model:{value:e.tagName,callback:r=>{this.$set(e,"tagName",r)}}})]),t("a-form-item",{attrs:{label:"\u6807\u7B7E\u8272"}},[t("ext-color-picker",{model:{value:e.tagBgColor,callback:r=>{this.$set(e,"tagBgColor",r)}}})])])])])}};const{defaultProps:U,editProps:O,wrapEditProps:G,hasCustomEditor:L}=T(P),C=()=>({topic:{id:p(),name:"\u9ED8\u8BA4\u8D27\u67B6"},products:[{id:p(),name:"\u5E94\u916C\u65CF\u4F53\u68C0\u5957\u9910",_coverImg:"https://img.mytijian.com/common/img/2022-04/1649903330-VTROoS.png",_price:2831,_linePrice:2900},{id:p(),name:"\u5915\u9633\u7EA2\u5347\u7EA7\u4F53\u68C0\u5957\u9910\uFF0C\u5173\u7231\u8001\u5E74\u5065\u5EB7\u751F\u6D3B",_coverImg:"https://img.mytijian.com/common/img/2022-04/1649903330-8tlqjz.png",_price:1676,_linePrice:2e3}]});var Q={data(){return{moduleProps:U}},mounted(){c.off(d),c.on(d,({data:t,success:e})=>{e(t?{data:C()}:{data:C()})}),c.off(v),c.on(v,({data:t,success:e,onProgress:o,fail:i})=>{const{file:s,type:r}=t;console.log(s,r);let l=1;const n=setInterval(()=>{l+=Math.ceil(Math.random()*10),o&&o(l),l>=100&&(clearInterval(n),e({name:"nav-menu5",url:"http://static.aitter.site/uPic/nav-menu5.png",type:"img"}))},100)})},render(){const t=arguments[0];return t("div",[t("demo-layout",{attrs:{editProps:O,wrapEditProps:G,defaultProps:this.moduleProps},scopedSlots:{left:e=>t(P,b([{},{props:f({},e)}])),right:e=>L?t(A,b([{},{props:{moduleProps:e}}])):null}})])}};export{Q as default};
